// BinaryTradingApplication.java
package com.example.trading;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class BinaryTradingApplication {
    public static void main(String[] args) {
        SpringApplication.run(BinaryTradingApplication.class, args);
    }
}

// TradeController.java
package com.example.trading.controller;

import com.example.trading.model.Trade;
import com.example.trading.service.TradeService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/trade")
@CrossOrigin(origins = "*")
public class TradeController {

    @Autowired
    private TradeService tradeService;

    @PostMapping("/execute")
    public Trade executeTrade(@RequestBody Trade trade) {
        return tradeService.executeTrade(trade);
    }

    @GetMapping("/history")
    public List<Trade> getTradeHistory() {
        return tradeService.getAllTrades();
    }
}

// Trade.java (Model)
package com.example.trading.model;

public class Trade {
    private String direction; // "UP" or "DOWN"
    private double amount;
    private boolean result;
    private double balanceAfterTrade;

    public String getDirection() {
        return direction;
    }

    public void setDirection(String direction) {
        this.direction = direction;
    }

    public double getAmount() {
        return amount;
    }

    public void setAmount(double amount) {
        this.amount = amount;
    }

    public boolean isResult() {
        return result;
    }

    public void setResult(boolean result) {
        this.result = result;
    }

    public double getBalanceAfterTrade() {
        return balanceAfterTrade;
    }

    public void setBalanceAfterTrade(double balanceAfterTrade) {
        this.balanceAfterTrade = balanceAfterTrade;
    }
}

// TradeService.java
package com.example.trading.service;

import com.example.trading.model.Trade;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;

@Service
public class TradeService {
    private double userBalance = 1000.0;
    private final List<Trade> trades = new ArrayList<>();

    public Trade executeTrade(Trade trade) {
        Random random = new Random();
        boolean win = random.nextBoolean();

        if (win) {
            userBalance += trade.getAmount();
        } else {
            userBalance -= trade.getAmount();
        }

        trade.setResult(win);
        trade.setBalanceAfterTrade(userBalance);
        trades.add(trade);
        return trade;
    }

    public List<Trade> getAllTrades() {
        return trades;
    }
}

// application.properties
server.port=8080
spring.resources.static-locations=classpath:/static/
